name: PR Interaction Bot

on:
  pull_request_target:
    types: [opened, closed]
  issues:
    types: [closed]

permissions:
  contents: read
  issues: write
  pull-requests: write

jobs:
  comment-on-activity:
    runs-on: ubuntu-latest
    steps:
      - name: Send Message
        uses: actions/github-script@v6
        with:
          script: |
            const owner = context.repo.owner;
            const repo = context.repo.repo;
            const eventName = context.eventName;
            const payload = context.payload;
            
            let author = '';
            if (payload.pull_request) {
              author = payload.pull_request.user.login;
            } else if (payload.issue) {
              author = payload.issue.user.login;
            } else {
              author = context.actor;
            }
            
            let message = '';

            if (eventName === 'pull_request_target' && payload.action === 'opened') {
              message = `Hi @${author}! ğŸ‘‹

            **Thanks for contributing to ${repo}!** ğŸ‰
            We appreciate your effort and will review your changes soon.

            ---

            â­ **Please star the repo if you like it!**
            ğŸ‘¤ **[Follow the owner](https://github.com/manasdutta04) for updates.**`;
            } 
            
            else if (eventName === 'pull_request_target' && payload.action === 'closed') {
              if (payload.pull_request.merged) {
                 message = `**PR Merged!** 

            Awesome work, @${author}! Your contribution has been added. 
            Looking forward to more changes from you in the future! ğŸ”¥

            ---

            â­ **Please star the repo if you like it!**
            ğŸ‘¤ **[Follow the owner](https://github.com/manasdutta04) for updates.**`;

              } else {
                 message = `**PR Closed**

            Thanks for your interest, @${author}. Even though this wasn't merged, we appreciate the effort!

            ---
              
            â­ **Please star the repo if you like it!**
            ğŸ‘¤ **[Follow the owner](https://github.com/manasdutta04) for updates.**`;

              }
            }

            else if (eventName === 'issues' && payload.action === 'closed') {
              message = `**Issue Resolved!**

            Thanks for helping us maintain the repo, @${author}. 
            If you have more ideas, feel free to open a new issue!

            ---

            â­ **Don't forget to star the repo!**
            ğŸ‘¤ **[Follow the owner](https://github.com/manasdutta04) for updates.**`;

            }

            if (message) {
              await github.rest.issues.createComment({
                owner: owner,
                repo: repo,
                issue_number: context.issue.number,
                body: message
              });
            }
